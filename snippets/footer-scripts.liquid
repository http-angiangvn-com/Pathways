{%- include 'option_selection_js' -%}
<script src="{{ 'api.jquery.js' | haravan_asset_url }}"></script>
{%- if template contains 'customers' -%}
{{ 'haravan_common.js' | haravan_asset_url | script_tag }}
{{ 'customer_area.js'  | haravan_asset_url | script_tag }}
{%- endif -%}
{%- include 'plugins-js' -%}
<script src="{{ 'jquery.angle.js' | asset_url }}"></script>
{%-if settings.promotion_hrvapp_use-%}
	{%-if settings.promotion_hrvapp == 'appcombo'-%}
		<script type="text/javascript" src="{{ 'app-combo.js'  | asset_url }}" defer></script>
	{%-elsif settings.promotion_hrvapp == 'appbuyxgety'-%}
		<script type="text/javascript" src="{{ 'app-buyxgety.js' | asset_url }}" defer></script>
	{%-endif-%}
{%-endif-%}	

{%- if template contains 'product' or template contains 'index' -%}
<!-- SCRIPT PRODUCT -->
{{ 'jquery.fancybox.min.js'  | asset_url | script_tag }}

{%- if settings.product_layout_style == 'style_03' or template == 'product.style-03' or settings.product_layout_style == 'style_04' or template == 'product.style-04' -%}
{{ 'slick.min.js'  | asset_url | script_tag }}
{%- endif -%}
{%- endif -%}
<!-- SCRIPT THEME -->

<script type="text/javascript" src="{{ 'scripts.js'  | asset_url }}" defer></script>
<script>
  $(window).on('load', function () {
    

if ($('.addThis_listSharing').length > 0){
  $(window).scroll(function(){
    if(jQuery(window).scrollTop() > 100 ) {
      jQuery('.addThis_listSharing').addClass('is-show');
    } else {
      jQuery('.addThis_listSharing').removeClass('is-show');
    }
  });
  $('.content_popupform form.contact-form').submit(function(e){
    var self = $(this);
    if($(this)[0].checkValidity() == true){
      e.preventDefault();		
      grecaptcha.ready(function() {
        grecaptcha.execute('6LdD18MUAAAAAHqKl3Avv8W-tREL6LangePxQLM-', {action: 'submit'}).then(function(token) {
          self.find('input[name="g-recaptcha-response"]').val(token);
          $.ajax({
            type: 'POST',
            url:'/contact',
            data: $('.content_popupform form.contact-form').serialize(),
            success:function(data){		
              if($(data).find('#success-popupform').length > 0){
                $('.content_popupform form.contact-form .error-formcontact').addClass('hidden').slideUp();
                $('.modal-contactform.fade.in').modal('hide');
                setTimeout(function(){ 		
                  $('.modal-succesform').modal('show');					
                  setTimeout(function(){							
                    $('.modal-succesform.fade.in').modal('hide');						
                  }, 5000);
                },300);
              }
              else{
                $('.content_popupform form.contact-form .error-formcontact').removeClass('hidden').slideDown('50');
              }
            }			
          })
        });
      });
    }
  });
  $(".modal-succesform").on('hidden.bs.modal', function() {
    location.reload();
  });
  }
});
</script>
<script type="text/javascript" src="{{ 't-datepicker.min.js'  | asset_url }}" defer></script>
{% unless template contains 'index' %}
<script>
jQuery(document).ready(function(){ 
	new WOW().init();
});
</script>
{{ 'wow.min.js'  | asset_url | script_tag }}
{%endunless%}

<!-- POPUP LOAD --> 
{%- if template contains 'index' -%}

  {{ 'index.js'  | asset_url | script_tag }}
 
	{%- if settings.popup_contact_show -%}
	<script>
	jQuery(document).ready(function(){
		{%- if settings.popup_contact_time == '0'  -%}
		{%- assign  time_show_popup = 100 -%}
		{% else %}
		{%- assign  time_show_popup = settings.popup_contact_time | times: 1000 -%}
		{% endif %}
		setTimeout(function(){
			if(sessionStorage.mega_popup == null ){
				$('#popup-contact').modal('show');
			}
		},{{time_show_popup}});
		 if ($('.popupForm').length > 0){
			 $('.popup-form-customer form.contact-form').submit(function(e){
				 var self = $(this);
				 if($(this)[0].checkValidity() == true){
					 e.preventDefault();
					 grecaptcha.ready(function() {
						 grecaptcha.execute('6LdD18MUAAAAAHqKl3Avv8W-tREL6LangePxQLM-', {action: 'submit'}).then(function(token) {
							 self.find('input[name="g-recaptcha-response"]').val(token);
							 $.ajax({
								 type: 'POST',
								 url:'/account/contact',
								 data: $('.popup-form-customer form.contact-form').serialize(),
								 success:function(data){
									 if($(data).find('#error_customer').length == 0){
										 $('.popup-form-customer .succes-popup').addClass('success').html('Cảm ơn bạn đã đăng ký email theo dõi!');
										 setTimeout(function(){ 
											 $('#popup-contact').modal('hide');
											 location.reload();
										 },1500);
									 }
									 else{
										 $('.popup-form-customer .succes-popup').addClass('error').html($(data).find('#error_customer').html());
									 }
								 }
							 })
						 })
					 });
				 }
				 if(sessionStorage.mega_popup == null ){
					 sessionStorage.mega_popup = 'show' ;
				 }		
			 });
		 }
		 else{
			 $(document).on('click','.linkbanner-popup-contact', function(){
				 $('#popup-contact').modal('hide');
				 if(sessionStorage.mega_popup == null ){
					 sessionStorage.mega_popup = 'show' ;
				 }
			 });
		 }
		 $(document).on('click','.modal-popupContact .close-popup-contact', function(e){
			 e.preventDefault();
			 $('#popup-contact').modal('hide');
			 if(sessionStorage.mega_popup == null ){
				 sessionStorage.mega_popup = 'show' ;
			 }
		 });
		 $(".modal-popupContact").on('hidden.bs.modal', function(){
			 if(sessionStorage.mega_popup == null ){
				 sessionStorage.mega_popup = 'show' ;
			 } 
		 });
		 $(document).on('click', '.popup-discount .cpi-button', function(e){ 
			 e.preventDefault();	
			 $('.popup-discount .cpi-button').html('Sao chép mã').removeClass('disabled');
			 var copyText = $(this).attr('data-coupon');
			 var dummy = $('<input class="copy-discount-text-hide">').val(copyText).appendTo('.popupPromotion').select();
			 dummy.focus();
			 document.execCommand('copy');
			 $('.copy-discount-text-hide').remove();
			 $(this).html('Đã sao chép').addClass('disabled');
		 });
		});
</script>
	{%- endif -%}
{%- endif -%}
<!--END *** POPUP LOAD =====================-->

{%-comment-%}
<!-- Fix Passive event listeners -->
<script>
	jQuery.event.special.touchstart = {
		setup: function( _, ns, handle ) {
			this.addEventListener("touchstart", handle, { passive: !ns.includes("noPreventDefault") });
		}
	};
	jQuery.event.special.touchmove = {
		setup: function( _, ns, handle ) {
			this.addEventListener("touchmove", handle, { passive: !ns.includes("noPreventDefault") });
		}
	};
</script>
{%-endcomment-%}

