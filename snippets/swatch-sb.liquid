{% assign found_option = false %}
{% assign is_color = false %}
{% assign option_index = 0 %}

{% for option in product.options limit: 2 %}
{% if option == swatch-sb %}
{% assign found_option = true %}
{% assign option_index = forloop.index0 %}

{% assign downcased_option = swatch-sb | downcase %}
{% if downcased_option contains 'màu sắc' or downcased_option contains 'màu' %}
{% assign is_color = true %}
{% endif %}
{% endif %}
{% endfor %}

{% unless found_option %}

{% else %}
<div id="variant-swatch-{{option_index }}-sb" class="swatch clearfix" data-option="option{{option_index | plus: 1 }}" data-option-index="{{ option_index }}">
	<div class="header hide">{{ swatch-sb }}:</div>
	{%-comment-%}
	{% if is_color == true %}
	<div class="header"><span></span></div>
	{% endif %}
	{%-endcomment-%}
	{%- if is_color == true -%}
	<div class="select-swap">  
		{% assign values = '' %}
		{% for variant in product.variants %}
		{% assign value = variant.options[option_index] %}
		{% unless values contains value %}
		{% assign values = values | join: ',' %}
		{% assign values = values | append: ',' | append: value %} 
		{% assign values = values | split: ',' %} 

		{%- comment -%}
		{% assign imgBG = '' %}
		{% assign valHanlde = value | handleize %}
		{% for img in product.images %}
		{% assign srcImg = img.src | downcase %}
		{% if srcImg contains 'color' and srcImg contains valHanlde %}
		{% assign imgBG = img.src | img_url: 'thumb'%}
		{% break %}
		{% endif %}
		{% endfor %}
		{%- endcomment -%}
		
		{% assign soldout = ''%}
		{% if product.options.size == 1 %}
		{% unless variant.available %}
		{% assign soldout = 'soldout'%}
		{% endunless %}
		{% endif %}

		<div data-value="{{ value | escape }}" class="n-sd swatch-element color {{ value | handle }} {% if option_index == 2 %}variant-3 {%endif%} {{soldout}}">
			<input class="variant-{{option_index}}" id="swatch-{{ option_index }}-{{ value | handle }}-sb" type="radio" name="option{{ option_index | plus: 1 }}" value="{{ value | escape }}" data-vhandle="{{ value | handle }}" {% if forloop.first %} checked{% endif %} {{disabled}}/>
			{% if is_color %}
			{% assign img_url = variant.image.src | img_url: 'small' %}
			<label class="{{ value | handle }}" for="swatch-{{ option_index }}-{{ value | handle }}-sb" >
				{%-comment-%}<span {% if imgBG != '' %}style="background-image: url({{ imgBG }});background-repeat: no-repeat;background-size: contain;"{% endif %}>{{value}}</span>{%-endcomment-%}
				<span>{{ value }}</span>
			</label>
			{% else %}
			<label for="swatch-{{ option_index }}-{{ value | handle }}-sb">
				<span>{{ value }}</span>
			</label>
			{% endif %}
		</div>
		{% endunless %}
		{% endfor %}
	</div>
	{%- else -%}
	<select class="select-swap" name="select-swap-sb" id="select-swap-sb">  
		{% assign values = '' %}
		{% for variant in product.variants %}
		{% assign value = variant.options[option_index] %}
		{% unless values contains value %}
		{% assign values = values | join: ',' %}
		{% assign values = values | append: ',' | append: value %} 
		{% assign values = values | split: ',' %} 
		
		{% assign soldout = ''%}
		{% if product.options.size == 1 %}
		{% unless variant.available %}
		{% assign soldout = 'soldout'%}
		{% endunless %}
		{% endif %}

		<option data-value="{{ value | handle }}" value="{{ value }}" class="n-sd swatch-element {{ value | handle }} {% if option_index == 2 %}variant-3 {%endif%} {{soldout}}">
			<label for="swatch-{{ option_index }}-{{ value | handle }}-sb">
				<span>{{ value }}</span>
			</label>
		</option>
		{% endunless %}
		{% endfor %}
	</select>
	{%- endif -%}
	
</div>
{% endunless %}



